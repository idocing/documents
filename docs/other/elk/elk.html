<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>elk</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/pagetoc.css">
        <link rel="stylesheet" href="../../theme/rust-syntax-bg-highlight.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../ai/nn.html"><strong aria-hidden="true">1.</strong> ai</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ai/nn.html"><strong aria-hidden="true">1.1.</strong> nn</a></li></ol></li><li class="chapter-item expanded "><a href="../../algorithm/algorithm.html"><strong aria-hidden="true">2.</strong> algorithm</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../algorithm/algorithm.html"><strong aria-hidden="true">2.1.</strong> algorithm</a></li></ol></li><li class="chapter-item expanded "><a href="../../c/gcc.html"><strong aria-hidden="true">3.</strong> c</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../c/gcc.html"><strong aria-hidden="true">3.1.</strong> gcc</a></li><li class="chapter-item expanded "><a href="../../c/sleep.html"><strong aria-hidden="true">3.2.</strong> sleep</a></li></ol></li><li class="chapter-item expanded "><a href="../../cmake/sample.html"><strong aria-hidden="true">4.</strong> cmake</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../cmake/cmakefile.html"><strong aria-hidden="true">4.1.</strong> cmakefile</a></li><li class="chapter-item expanded "><a href="../../cmake/command.html"><strong aria-hidden="true">4.2.</strong> command</a></li><li class="chapter-item expanded "><a href="../../cmake/example.html"><strong aria-hidden="true">4.3.</strong> example</a></li><li class="chapter-item expanded "><a href="../../cmake/sample.html"><strong aria-hidden="true">4.4.</strong> sample</a></li></ol></li><li class="chapter-item expanded "><a href="../../crypto/openssl.html"><strong aria-hidden="true">5.</strong> crypto</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../crypto/openssl.html"><strong aria-hidden="true">5.1.</strong> openssl</a></li><li class="chapter-item expanded "><a href="../../crypto/rsa.html"><strong aria-hidden="true">5.2.</strong> rsa</a></li></ol></li><li class="chapter-item expanded "><a href="../../csharp/vscode.html"><strong aria-hidden="true">6.</strong> csharp</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../csharp/vscode.html"><strong aria-hidden="true">6.1.</strong> vscode</a></li></ol></li><li class="chapter-item expanded "><a href="../../cxx/export.html"><strong aria-hidden="true">7.</strong> cxx</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../cxx/export.html"><strong aria-hidden="true">7.1.</strong> export</a></li></ol></li><li class="chapter-item expanded "><a href="../../db/explain.html"><strong aria-hidden="true">8.</strong> db</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../db/explain.html"><strong aria-hidden="true">8.1.</strong> explain</a></li><li class="chapter-item expanded "><a href="../../db/lock.html"><strong aria-hidden="true">8.2.</strong> lock</a></li><li class="chapter-item expanded "><a href="../../db/mysql.html"><strong aria-hidden="true">8.3.</strong> mysql</a></li><li class="chapter-item expanded "><a href="../../db/pg_function.html"><strong aria-hidden="true">8.4.</strong> pg_function</a></li><li class="chapter-item expanded "><a href="../../db/pg_locks.html"><strong aria-hidden="true">8.5.</strong> pg_locks</a></li><li class="chapter-item expanded "><a href="../../db/pg_size.html"><strong aria-hidden="true">8.6.</strong> pg_size</a></li><li class="chapter-item expanded "><a href="../../db/postgres.html"><strong aria-hidden="true">8.7.</strong> postgres</a></li><li class="chapter-item expanded "><a href="../../db/recursive.html"><strong aria-hidden="true">8.8.</strong> recursive</a></li><li class="chapter-item expanded "><a href="../../db/uuid.html"><strong aria-hidden="true">8.9.</strong> uuid</a></li></ol></li><li class="chapter-item expanded "><a href="../../docker/copy&add.html"><strong aria-hidden="true">9.</strong> docker</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../docker/es/elk.html"><strong aria-hidden="true">9.1.</strong> es</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../docker/es/elk.html"><strong aria-hidden="true">9.1.1.</strong> elk</a></li><li class="chapter-item expanded "><a href="../../docker/es/elk_docker.html"><strong aria-hidden="true">9.1.2.</strong> elk_docker</a></li></ol></li><li class="chapter-item expanded "><a href="../../docker/copy&add.html"><strong aria-hidden="true">9.2.</strong> copy&add</a></li><li class="chapter-item expanded "><a href="../../docker/d-bus.html"><strong aria-hidden="true">9.3.</strong> d-bus</a></li><li class="chapter-item expanded "><a href="../../docker/debian.html"><strong aria-hidden="true">9.4.</strong> debian</a></li><li class="chapter-item expanded "><a href="../../docker/docker.html"><strong aria-hidden="true">9.5.</strong> docker</a></li><li class="chapter-item expanded "><a href="../../docker/golang.html"><strong aria-hidden="true">9.6.</strong> golang</a></li><li class="chapter-item expanded "><a href="../../docker/manifest.html"><strong aria-hidden="true">9.7.</strong> manifest</a></li><li class="chapter-item expanded "><a href="../../docker/mysql.html"><strong aria-hidden="true">9.8.</strong> mysql</a></li><li class="chapter-item expanded "><a href="../../docker/other.html"><strong aria-hidden="true">9.9.</strong> other</a></li><li class="chapter-item expanded "><a href="../../docker/postgresql.html"><strong aria-hidden="true">9.10.</strong> postgresql</a></li><li class="chapter-item expanded "><a href="../../docker/qemu.html"><strong aria-hidden="true">9.11.</strong> qemu</a></li><li class="chapter-item expanded "><a href="../../docker/recover.html"><strong aria-hidden="true">9.12.</strong> recover</a></li><li class="chapter-item expanded "><a href="../../docker/redis.html"><strong aria-hidden="true">9.13.</strong> redis</a></li><li class="chapter-item expanded "><a href="../../docker/rootfs.html"><strong aria-hidden="true">9.14.</strong> rootfs</a></li><li class="chapter-item expanded "><a href="../../docker/run.html"><strong aria-hidden="true">9.15.</strong> run</a></li><li class="chapter-item expanded "><a href="../../docker/scratch.html"><strong aria-hidden="true">9.16.</strong> scratch</a></li><li class="chapter-item expanded "><a href="../../docker/vlmcsd.html"><strong aria-hidden="true">9.17.</strong> vlmcsd</a></li></ol></li><li class="chapter-item expanded "><a href="../../error/linux.html"><strong aria-hidden="true">10.</strong> error</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../error/linux.html"><strong aria-hidden="true">10.1.</strong> linux</a></li></ol></li><li class="chapter-item expanded "><a href="../../git/hooks.html"><strong aria-hidden="true">11.</strong> git</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../git/hooks.html"><strong aria-hidden="true">11.1.</strong> hooks</a></li><li class="chapter-item expanded "><a href="../../git/reset.html"><strong aria-hidden="true">11.2.</strong> reset</a></li><li class="chapter-item expanded "><a href="../../git/status.html"><strong aria-hidden="true">11.3.</strong> status</a></li></ol></li><li class="chapter-item expanded "><a href="../../go/install.html"><strong aria-hidden="true">12.</strong> go</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../go/install.html"><strong aria-hidden="true">12.1.</strong> install</a></li><li class="chapter-item expanded "><a href="../../go/json.html"><strong aria-hidden="true">12.2.</strong> json</a></li><li class="chapter-item expanded "><a href="../../go/micro.html"><strong aria-hidden="true">12.3.</strong> micro</a></li><li class="chapter-item expanded "><a href="../../go/mod.html"><strong aria-hidden="true">12.4.</strong> mod</a></li><li class="chapter-item expanded "><a href="../../go/pkg.html"><strong aria-hidden="true">12.5.</strong> pkg</a></li><li class="chapter-item expanded "><a href="../../go/printf.html"><strong aria-hidden="true">12.6.</strong> printf</a></li><li class="chapter-item expanded "><a href="../../go/type.html"><strong aria-hidden="true">12.7.</strong> type</a></li><li class="chapter-item expanded "><a href="../../go/vscode.html"><strong aria-hidden="true">12.8.</strong> vscode</a></li></ol></li><li class="chapter-item expanded "><a href="../../install/alpine.html"><strong aria-hidden="true">13.</strong> install</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../install/alpine.html"><strong aria-hidden="true">13.1.</strong> alpine</a></li><li class="chapter-item expanded "><a href="../../install/inno.html"><strong aria-hidden="true">13.2.</strong> inno</a></li><li class="chapter-item expanded "><a href="../../install/lang.html"><strong aria-hidden="true">13.3.</strong> lang</a></li><li class="chapter-item expanded "><a href="../../install/linux.html"><strong aria-hidden="true">13.4.</strong> linux</a></li><li class="chapter-item expanded "><a href="../../install/opencv.html"><strong aria-hidden="true">13.5.</strong> opencv</a></li><li class="chapter-item expanded "><a href="../../install/wxWidgets.html"><strong aria-hidden="true">13.6.</strong> wxWidgets</a></li></ol></li><li class="chapter-item expanded "><a href="../../java/jvm.html"><strong aria-hidden="true">14.</strong> java</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../java/maven/maven.html"><strong aria-hidden="true">14.1.</strong> maven</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../java/maven/maven.html"><strong aria-hidden="true">14.1.1.</strong> maven</a></li></ol></li><li class="chapter-item expanded "><a href="../../java/springboot/logback.html"><strong aria-hidden="true">14.2.</strong> springboot</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../java/springboot/logback.html"><strong aria-hidden="true">14.2.1.</strong> logback</a></li><li class="chapter-item expanded "><a href="../../java/springboot/logback-define.html"><strong aria-hidden="true">14.2.2.</strong> logback-define</a></li></ol></li><li class="chapter-item expanded "><a href="../../java/command.html"><strong aria-hidden="true">14.3.</strong> command</a></li><li class="chapter-item expanded "><a href="../../java/docker.html"><strong aria-hidden="true">14.4.</strong> docker</a></li></ol></li><li class="chapter-item expanded "><a href="../../linux/base.html"><strong aria-hidden="true">15.</strong> linux</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../linux/alpine/alpine.html"><strong aria-hidden="true">15.1.</strong> alpine</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../linux/alpine/alpine.html"><strong aria-hidden="true">15.1.1.</strong> alpine</a></li><li class="chapter-item expanded "><a href="../../linux/alpine/docker.html"><strong aria-hidden="true">15.1.2.</strong> docker</a></li></ol></li><li class="chapter-item expanded "><a href="../../linux/tools/tar.html"><strong aria-hidden="true">15.2.</strong> tools</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../linux/tools/tar.html"><strong aria-hidden="true">15.2.1.</strong> tar</a></li></ol></li><li class="chapter-item expanded "><a href="../../linux/base.html"><strong aria-hidden="true">15.3.</strong> base</a></li><li class="chapter-item expanded "><a href="../../linux/centos.html"><strong aria-hidden="true">15.4.</strong> centos</a></li><li class="chapter-item expanded "><a href="../../linux/curl.html"><strong aria-hidden="true">15.5.</strong> curl</a></li><li class="chapter-item expanded "><a href="../../linux/debian.html"><strong aria-hidden="true">15.6.</strong> debian</a></li><li class="chapter-item expanded "><a href="../../linux/lang.html"><strong aria-hidden="true">15.7.</strong> lang</a></li><li class="chapter-item expanded "><a href="../../linux/replace.html"><strong aria-hidden="true">15.8.</strong> replace</a></li><li class="chapter-item expanded "><a href="../../linux/source.html"><strong aria-hidden="true">15.9.</strong> source</a></li><li class="chapter-item expanded "><a href="../../linux/ssh.html"><strong aria-hidden="true">15.10.</strong> ssh</a></li><li class="chapter-item expanded "><a href="../../linux/sshd.html"><strong aria-hidden="true">15.11.</strong> sshd</a></li><li class="chapter-item expanded "><a href="../../linux/ubuntu.html"><strong aria-hidden="true">15.12.</strong> ubuntu</a></li><li class="chapter-item expanded "><a href="../../linux/user.html"><strong aria-hidden="true">15.13.</strong> user</a></li></ol></li><li class="chapter-item expanded "><a href="../../mac/brew.html"><strong aria-hidden="true">16.</strong> mac</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../mac/brew.html"><strong aria-hidden="true">16.1.</strong> brew</a></li><li class="chapter-item expanded "><a href="../../mac/brewcn.html"><strong aria-hidden="true">16.2.</strong> brewcn</a></li><li class="chapter-item expanded "><a href="../../mac/homebrew.html"><strong aria-hidden="true">16.3.</strong> homebrew</a></li><li class="chapter-item expanded "><a href="../../mac/launchpad.html"><strong aria-hidden="true">16.4.</strong> launchpad</a></li></ol></li><li class="chapter-item expanded "><a href="../../net/net.html"><strong aria-hidden="true">17.</strong> net</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../net/net.html"><strong aria-hidden="true">17.1.</strong> net</a></li></ol></li><li class="chapter-item expanded "><a href="../../other/elk/elk.html" class="active"><strong aria-hidden="true">18.</strong> other</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../other/elk/elk.html" class="active"><strong aria-hidden="true">18.1.</strong> elk</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../other/elk/elk.html" class="active"><strong aria-hidden="true">18.1.1.</strong> elk</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../python/conda.html"><strong aria-hidden="true">19.</strong> python</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../python/conda.html"><strong aria-hidden="true">19.1.</strong> conda</a></li><li class="chapter-item expanded "><a href="../../python/definition.html"><strong aria-hidden="true">19.2.</strong> definition</a></li><li class="chapter-item expanded "><a href="../../python/import.html"><strong aria-hidden="true">19.3.</strong> import</a></li><li class="chapter-item expanded "><a href="../../python/jupyter.html"><strong aria-hidden="true">19.4.</strong> jupyter</a></li><li class="chapter-item expanded "><a href="../../python/other.html"><strong aria-hidden="true">19.5.</strong> other</a></li><li class="chapter-item expanded "><a href="../../python/pip.html"><strong aria-hidden="true">19.6.</strong> pip</a></li></ol></li><li class="chapter-item expanded "><a href="../../react/env.html"><strong aria-hidden="true">20.</strong> react</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../react/env.html"><strong aria-hidden="true">20.1.</strong> env</a></li></ol></li><li class="chapter-item expanded "><a href="../../rust/attribute.html"><strong aria-hidden="true">21.</strong> rust</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../rust/attribute.html"><strong aria-hidden="true">21.1.</strong> attribute</a></li><li class="chapter-item expanded "><a href="../../rust/build.html"><strong aria-hidden="true">21.2.</strong> build</a></li><li class="chapter-item expanded "><a href="../../rust/cargo.html"><strong aria-hidden="true">21.3.</strong> cargo</a></li><li class="chapter-item expanded "><a href="../../rust/cfg.html"><strong aria-hidden="true">21.4.</strong> cfg</a></li><li class="chapter-item expanded "><a href="../../rust/crates.html"><strong aria-hidden="true">21.5.</strong> crates</a></li><li class="chapter-item expanded "><a href="../../rust/env.html"><strong aria-hidden="true">21.6.</strong> env</a></li><li class="chapter-item expanded "><a href="../../rust/link.html"><strong aria-hidden="true">21.7.</strong> link</a></li><li class="chapter-item expanded "><a href="../../rust/pointer.html"><strong aria-hidden="true">21.8.</strong> pointer</a></li><li class="chapter-item expanded "><a href="../../rust/registry.html"><strong aria-hidden="true">21.9.</strong> registry</a></li><li class="chapter-item expanded "><a href="../../rust/rsproxy.html"><strong aria-hidden="true">21.10.</strong> rsproxy</a></li><li class="chapter-item expanded "><a href="../../rust/rustup.html"><strong aria-hidden="true">21.11.</strong> rustup</a></li><li class="chapter-item expanded "><a href="../../rust/source.html"><strong aria-hidden="true">21.12.</strong> source</a></li><li class="chapter-item expanded "><a href="../../rust/syntax.html"><strong aria-hidden="true">21.13.</strong> syntax</a></li><li class="chapter-item expanded "><a href="../../rust/triples.html"><strong aria-hidden="true">21.14.</strong> triples</a></li><li class="chapter-item expanded "><a href="../../rust/vendor.html"><strong aria-hidden="true">21.15.</strong> vendor</a></li></ol></li><li class="chapter-item expanded "><a href="../../server/ca.html"><strong aria-hidden="true">22.</strong> server</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../server/ca.html"><strong aria-hidden="true">22.1.</strong> ca</a></li><li class="chapter-item expanded "><a href="../../server/caddy.html"><strong aria-hidden="true">22.2.</strong> caddy</a></li><li class="chapter-item expanded "><a href="../../server/nginx.html"><strong aria-hidden="true">22.3.</strong> nginx</a></li><li class="chapter-item expanded "><a href="../../server/pem.html"><strong aria-hidden="true">22.4.</strong> pem</a></li></ol></li><li class="chapter-item expanded "><a href="../../ssh/ssh.html"><strong aria-hidden="true">23.</strong> ssh</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ssh/ssh.html"><strong aria-hidden="true">23.1.</strong> ssh</a></li></ol></li><li class="chapter-item expanded "><a href="../../sys/proxy.html"><strong aria-hidden="true">24.</strong> sys</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../sys/proxy.html"><strong aria-hidden="true">24.1.</strong> proxy</a></li></ol></li><li class="chapter-item expanded "><a href="../../vi/vi.html"><strong aria-hidden="true">25.</strong> vi</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../vi/vi.html"><strong aria-hidden="true">25.1.</strong> vi</a></li></ol></li><li class="chapter-item expanded "><a href="../../vscode/edit.html"><strong aria-hidden="true">26.</strong> vscode</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../vscode/edit.html"><strong aria-hidden="true">26.1.</strong> edit</a></li><li class="chapter-item expanded "><a href="../../vscode/go.html"><strong aria-hidden="true">26.2.</strong> go</a></li><li class="chapter-item expanded "><a href="../../vscode/java.html"><strong aria-hidden="true">26.3.</strong> java</a></li><li class="chapter-item expanded "><a href="../../vscode/keymap.html"><strong aria-hidden="true">26.4.</strong> keymap</a></li><li class="chapter-item expanded "><a href="../../vscode/mvn.html"><strong aria-hidden="true">26.5.</strong> mvn</a></li><li class="chapter-item expanded "><a href="../../vscode/svn.html"><strong aria-hidden="true">26.6.</strong> svn</a></li></ol></li><li class="chapter-item expanded "><a href="../../vue/vue.html"><strong aria-hidden="true">27.</strong> vue</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../vue/vue.html"><strong aria-hidden="true">27.1.</strong> vue</a></li><li class="chapter-item expanded "><a href="../../vue/deploy.html"><strong aria-hidden="true">27.2.</strong> deploy</a></li><li class="chapter-item expanded "><a href="../../vue/svg.html"><strong aria-hidden="true">27.3.</strong> svg</a></li></ol></li><li class="chapter-item expanded "><a href="../../windows/install.html"><strong aria-hidden="true">28.</strong> windows</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../windows/cmd.html"><strong aria-hidden="true">28.1.</strong> cmd</a></li><li class="chapter-item expanded "><a href="../../windows/env.html"><strong aria-hidden="true">28.2.</strong> env</a></li><li class="chapter-item expanded "><a href="../../windows/install.html"><strong aria-hidden="true">28.3.</strong> install</a></li><li class="chapter-item expanded "><a href="../../windows/msi.html"><strong aria-hidden="true">28.4.</strong> msi</a></li><li class="chapter-item expanded "><a href="../../windows/proxy.html"><strong aria-hidden="true">28.5.</strong> proxy</a></li><li class="chapter-item expanded "><a href="../../windows/reg.html"><strong aria-hidden="true">28.6.</strong> reg</a></li><li class="chapter-item expanded "><a href="../../windows/service.html"><strong aria-hidden="true">28.7.</strong> service</a></li></ol></li><li class="chapter-item expanded "><a href="../../index.html"><strong aria-hidden="true">29.</strong> Readme</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <h1 id="一前言"><a class="header" href="#一前言">一、前言</a></h1>
<h2 id="1-elk简介"><a class="header" href="#1-elk简介">1. ELK简介</a></h2>
<p>ELK是Elasticsearch+Logstash+Kibana的简称</p>
<ul>
<li>
<p>ElasticSearch是一个基于Lucene的分布式全文搜索引擎，提供 RESTful API进行数据读写</p>
</li>
<li>
<p>Logstash是一个收集，处理和转发事件和日志消息的工具</p>
</li>
<li>
<p>Kibana是Elasticsearch的开源数据可视化插件，为查看存储在ElasticSearch提供了友好的Web界面，并提供了条形图，线条和散点图，饼图和地图等分析工具</p>
</li>
</ul>
<p>总的来说，ElasticSearch负责存储数据，Logstash负责收集日志，并将日志格式化后写入ElasticSearch，Kibana提供可视化访问ElasticSearch数据的功能。</p>
<h2 id="2elk工作流"><a class="header" href="#2elk工作流">2、ELK工作流</a></h2>
<p>ELK工作流</p>
<p>应用将日志按照约定的Key写入Redis，Logstash从Redis中读取日志信息写入ElasticSearch集群。Kibana读取ElasticSearch中的日志，并在Web页面中以表格/图表的形式展示。</p>
<h1 id="二准备工作"><a class="header" href="#二准备工作">二、准备工作</a></h1>
<h2 id="1服务器软件环境说明"><a class="header" href="#1服务器软件环境说明">1、服务器&amp;软件环境说明</a></h2>
<ul>
<li>服务器</li>
</ul>
<p>一共准备3台CentOS7 Server</p>
<p>es1	192.168.1.31	部署ElasticSearch主节点</p>
<p>es2	192.168.1.32	部署ElasticSearch从节点</p>
<p>elk	192.168.1.21	部署Logstash + Kibana + Redis</p>
<p>这里为了节省，只部署2台Elasticsearch，并将Logstash + Kibana + Redis部署在了一台机器上。
如果在生产环境部署，可以按照自己的需求调整。</p>
<ul>
<li>软件环境</li>
</ul>
<p>Linux Server	CentOS 7</p>
<p>Elasticsearch	7.0.0</p>
<p>Logstash	7.0.0</p>
<p>Kibana	7.0.0</p>
<p>Redis	4.0</p>
<p>JDK	1.8</p>
<h2 id="2elk环境准备"><a class="header" href="#2elk环境准备">2、ELK环境准备</a></h2>
<p>由于Elasticsearch、Logstash、Kibana均不能以root账号运行。
但是Linux对非root账号可并发操作的文件、线程都有限制。
所以，部署ELK相关的机器都要调整：</p>
<ul>
<li>修改文件限制</li>
</ul>
<pre><code># 修改系统文件
vi /etc/security/limits.conf

#增加的内容

* soft nofile 65536
* hard nofile 65536
* soft nproc 2048
* hard nproc 4096
</code></pre>
<ul>
<li>调整进程数</li>
</ul>
<pre><code>#修改系统文件
vi /etc/security/limits.d/20-nproc.conf
 
#调整成以下配置
*          soft    nproc     4096
root       soft    nproc     unlimited
</code></pre>
<ul>
<li>调整虚拟内存&amp;最大并发连接</li>
</ul>
<pre><code>#修改系统文件
vi /etc/sysctl.conf
 
#增加的内容
vm.max_map_count=655360
fs.file-max=655360
</code></pre>
<p>以上操作重启系统后生效</p>
<ul>
<li>JDK安装</li>
</ul>
<pre><code>rpm -iv jdk.rpm
</code></pre>
<ul>
<li>创建专用用户</li>
</ul>
<pre><code>useradd elk
</code></pre>
<ul>
<li>创建相关目录并赋权</li>
</ul>
<pre><code>#创建应用目录
mkdir /opt/elk
#创建数据目录
mkdir /elk
 
#更改目录拥有者
chown -R elk:elk /opt/elk
chown -R elk:elk /elk
</code></pre>
<ul>
<li>下载包并解压</li>
</ul>
<pre><code>#打开文件夹
cd /home/download
 
#下载
wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.0.0.tar.gz
wget https://artifacts.elastic.co/downloads/logstash/logstash-7.0.0.tar.gz
wget https://artifacts.elastic.co/downloads/kibana/kibana-7.0.0.tar.gz
 
#解压
tar -zvxf elasticsearch-7.0.0.tar.gz
tar -zvxf logstash-7.0.0.tar.gz
tar -zvxf kibana-7.0.0.tar.gz
</code></pre>
<h1 id="三elasticsearch-部署"><a class="header" href="#三elasticsearch-部署">三、Elasticsearch 部署</a></h1>
<p>本次一共要部署两个Elasticsearch节点，所有文中没有指定机器的操作都表示每个Elasticsearch机器都要执行该操作</p>
<h2 id="1准备工作"><a class="header" href="#1准备工作">1、准备工作</a></h2>
<ul>
<li>移动Elasticsearch到统一目录</li>
</ul>
<pre><code>#移动目录
mv /home/download/elasticsearch-7.0.0 /opt/elk
#赋权
chown -R elk:elk /opt/elk/elasticsearch-7.0.0
</code></pre>
<ul>
<li>开放端口</li>
</ul>
<pre><code>#增加端口
firewall-cmd --add-port=9200/tcp --permanent
firewall-cmd --add-port=9300/tcp --permanent
 
#重新加载防火墙规则
firewall-cmd --reload
</code></pre>
<p>-切换账号</p>
<pre><code>su - elk
</code></pre>
<ul>
<li>数据&amp;日志目录</li>
</ul>
<pre><code>创建Elasticsearch主目录
mkdir /elk/es
#创建Elasticsearch数据目录
mkdir /elk/es/data
#创建Elasticsearch日志目录
mkdir /elk/es/logs
</code></pre>
<h2 id="2elasticsearch节点配置"><a class="header" href="#2elasticsearch节点配置">2、Elasticsearch节点配置</a></h2>
<ul>
<li>修改配置</li>
</ul>
<pre><code>#打开目录
cd /opt/elk/elasticsearch-7.0.0
 
#修改配置
 
vi config/elasticsearch.yml
</code></pre>
<ul>
<li>主节点配置（192.168.1.31）</li>
</ul>
<pre><code>cluster.name: es 
node.name: es1
path.data: /elk/es/data
path.logs: /elk/es/logs
network.host: 192.168.1.31
http.port: 9200
transport.tcp.port: 9300
node.master: true
node.data: true
discovery.zen.ping.unicast.hosts: ["192.168.1.31:9300","192.168.1.32:9300"]
discovery.zen.minimum_master_nodes: 1
</code></pre>
<ul>
<li>从节点配置（192.168.1.32）</li>
</ul>
<pre><code>cluster.name: es 
node.name: es2
path.data: /elk/es/data
path.logs: /elk/es/logs
network.host: 192.168.1.32
http.port: 9200
transport.tcp.port: 9300
node.master: false
node.data: true
discovery.zen.ping.unicast.hosts: ["192.168.1.31:9300","192.168.1.32:9300"]
discovery.zen.minimum_master_nodes: 1
</code></pre>
<ul>
<li>配置项说明</li>
</ul>
<pre><code>配置    说明
cluster.name	集群名
node.name	节点名
path.data	数据保存目录
path.logs	日志保存目录
network.host	节点host/ip
http.port	HTTP访问端口
transport.tcp.port	TCP传输端口
node.master	是否允许作为主节点
node.data	是否保存数据
discovery.zen.ping.unicast.hosts	集群中的主节点的初始列表,当节点(主节点或者数据节点)启动时使用这个列表进行探测
discovery.zen.minimum_master_nodes	主节点个数
</code></pre>
<h2 id="3elasticsearch启动健康检查"><a class="header" href="#3elasticsearch启动健康检查">3、Elasticsearch启动&amp;健康检查</a></h2>
<ul>
<li>启动</li>
</ul>
<pre><code>#进入elasticsearch根目录
cd /opt/elk/elasticsearch-7.0.0
#启动
./bin/elasticsearch
</code></pre>
<ul>
<li>查看健康状态</li>
</ul>
<pre><code>curl http://192.168.1.31:9200/_cluster/health
</code></pre>
<p>如果返回status=green表示正常</p>
<pre><code>{
  "cluster_name": "esc",
  "status": "green",
  "timed_out": false,
  "number_of_nodes": 2,
  "number_of_data_nodes": 2,
  "active_primary_shards": 0,
  "active_shards": 0,
  "relocating_shards": 0,
  "initializing_shards": 0,
  "unassigned_shards": 0,
  "delayed_unassigned_shards": 0,
  "number_of_pending_tasks": 0,
  "number_of_in_flight_fetch": 0,
  "task_max_waiting_in_queue_millis": 0,
  "active_shards_percent_as_number": 100.0
}
</code></pre>
<h1 id="四logstash-部署"><a class="header" href="#四logstash-部署">四、Logstash 部署</a></h1>
<h2 id="1准备工作-1"><a class="header" href="#1准备工作-1">1、准备工作</a></h2>
<ul>
<li>
<p>部署Redis(略)</p>
</li>
<li>
<p>移动Logstash到统一目录</p>
</li>
</ul>
<pre><code>#移动目录
mv /home/download/logstash-7.0.0 /opt/elk
#赋权
chown -R elk:elk /opt/elk/logstash-7.0.0
</code></pre>
<ul>
<li>切换账号</li>
</ul>
<pre><code>#账号切换到 elk
su - elk
</code></pre>
<ul>
<li>数据&amp;日志目录</li>
</ul>
<pre><code>#创建Logstash主目录
mkdir /elk/logstash
#创建Logstash数据目录
mkdir /elk/logstash/data
#创建Logstash日志目录
mkdir /elk/logstash/logs
</code></pre>
<h2 id="2logstash配置"><a class="header" href="#2logstash配置">2、Logstash配置</a></h2>
<ul>
<li>配置数据&amp;日志目录</li>
</ul>
<pre><code>#打开目录
cd /opt/elk/logstash-7.0.0
#修改配置
vi config/logstash.yml
 
#增加以下内容
path.data: /elk/logstash/data
path.logs: /elk/logstash/logs
</code></pre>
<ul>
<li>配置Redis&amp;Elasticsearch</li>
</ul>
<pre><code>vi config/input-output.conf
 
#配置内容
 
input {
  redis {
    data_type =&gt; "list"
    key =&gt; "logstash"
    host =&gt; "192.168.1.21"
    port =&gt; 6379
    threads =&gt; 5
    codec =&gt; "json"
  }
}
filter {
}
output {
  elasticsearch {
    hosts =&gt; ["192.168.1.31:9200","192.168.1.32:9200"]
    index =&gt; "logstash-%{type}-%{+YYYY.MM.dd}"
    document_type =&gt; "%{type}"
  }
  stdout {
  }
}
</code></pre>
<p>该配置就是从redis中读取数据，然后写入指定的elasticsearch。
Redis核心配置项说明：</p>
<pre><code>配置项	说明
data_type =&gt; "list"	数据类型为list
key =&gt; "logstash"	缓存key为：logstash
codec =&gt; "json"	数据格式为：json
</code></pre>
<ul>
<li>启动</li>
</ul>
<pre><code>#进入Logstash根目录
cd /opt/elk/logstash-7.0.0
#测试
./bin/logstash -t -f config/input-output.conf
#启动
./bin/logstash -f config/input-output.conf
</code></pre>
<p>启动成功后，在启动输出的最后一行会看到如下信息：</p>
<pre><code>[INFO ][logstash.pipeline        ] Pipeline started {"pipeline.id"=&gt;"main"}
[INFO ][logstash.agent           ] Pipelines running {:count=&gt;1, :pipelines=&gt;["main"]}
</code></pre>
<h1 id="五kibana-部署"><a class="header" href="#五kibana-部署">五、Kibana 部署</a></h1>
<h2 id="1准备工作-2"><a class="header" href="#1准备工作-2">1、准备工作</a></h2>
<ul>
<li>移动Kibana到统一目录</li>
</ul>
<pre><code>#移动目录
mv /home/download/kibana-7.0.0 /opt/elk/kibana-7.0.0
#赋权
chown -R elk:elk /usr/elk/kibana-7.0.0
</code></pre>
<ul>
<li>开放端口</li>
</ul>
<pre><code>#增加端口
firewall-cmd --add-port=5601/tcp --permanent
 
#重新加载防火墙规则
firewall-cmd --reload
</code></pre>
<ul>
<li>切换账号</li>
</ul>
<pre><code>#账号切换到 elk
su - elk
</code></pre>
<h2 id="3kibana配置与访问测试"><a class="header" href="#3kibana配置与访问测试">3、Kibana配置与访问测试</a></h2>
<ul>
<li>修改配置</li>
</ul>
<pre><code>#进入kibana-7.0.0根目录
cd /opt/elk/kibana-7.0.0
#修改配置
vi config/kibana.yml
 
#增加以下内容
server.port: 5601
server.host: "192.168.1.21"
elasticsearch.url: "http://192.168.1.31:9200" 
</code></pre>
<ul>
<li>启动</li>
</ul>
<pre><code>#进入kibana-7.0.0根目录
cd /opt/elk/kibana-7.0.0
#启动
./bin/kibana
</code></pre>
<ul>
<li>访问</li>
</ul>
<p>http://192.168.1.21:5601</p>
<h1 id="六测试"><a class="header" href="#六测试">六、测试</a></h1>
<h2 id="1日志写入"><a class="header" href="#1日志写入">1、日志写入</a></h2>
<p>日历写入的话，写入到logstash监听的redis即可。
数据类型之前在/opt/elk/logstash-7.0.0/config/input-uput.conf中有配置</p>
<ul>
<li>Redis命令方式</li>
</ul>
<pre><code>#启动redis客户端
#执行以下命令
lpush logstash '{"host":"127.0.0.1","type":"logtest","message":"hello"}'
</code></pre>
<ul>
<li>Java代码批量写入（引入Jedis）</li>
</ul>
<pre><code>Jedis jedis = new Jedis("192.168.1.21", 6379);
for (int i = 0; i &lt; 1000; i++) {
    jedis.lpush("logstash", "{\"host\":\"127.0.0.1\",\"type\":\"logtest\",\"message\":\"" + i + "\"}");
}
</code></pre>
<h2 id="2kibana使用"><a class="header" href="#2kibana使用">2、Kibana使用</a></h2>
<pre><code>http://192.168.1.21:5601/app/kibana#/discover
</code></pre>
<h1 id="other"><a class="header" href="#other">Other</a></h1>
<h2 id="logstash配置"><a class="header" href="#logstash配置">Logstash配置</a></h2>
<ul>
<li>配置参数</li>
</ul>
<pre><code>file：顾名思义，直接读文件
stdin: 标准输入，调试配置的时候玩玩
syslog: syslog协议的日志格式，比如linux的rsyslog
tcp/udp：使用tcp或udp传输过来的日志
</code></pre>
<pre><code>path: 日志文件或目录的绝对路径，也可以是通配符的。
type: 类型，自定义
start_position: logstash 从什么位置开始读取文件数据，默认是结束位置，也就是说 logstash 进程会以类似 tail -F 的形式运行。如果你是要导入原有数据，把这个设定改成 "beginning"，logstash 进程就从头开始读取，类似 less +F 的形式运行。
codec: codec配置，通过它可以更好更方便的与其他有自定义数据格式的运维产品共存，比如 graphite、fluent、netflow、collectd，以及使用 msgpack、json、edn 等通用数据格式的其他产品等。
</code></pre>
<ul>
<li>config.conf</li>
</ul>
<pre><code>input {
    file {
        #指定单一文件
        path =&gt; "/data/es/logstash/files/test.log"
        #指定数组文件
        #path =&gt; ["/data/es/logstash/files/test-1.log","/data/es/logstash/files/test-2.log"]
        #指定同级目录模糊匹配
        #path =&gt; "/data/es/logstash/files/test*.log"
        #指定多级目录模糊匹配
        #path =&gt; "/data/es/logstash/files/**/test*.log"

        #当存在多个文件的时候可使用type指定输入输出路径
        type =&gt; "log_index"
        
        #可设置成begining或end，begining表示从头开始读取文件，end表示读取最新数据，可和ignore_older一起使用
        #begining只针对首次启动是否需要读取所有的历史数据，而当文件修改了之后，同样会自动增量更新新数据
        start_position =&gt; "beginning"

        #设置输入规则
        codec =&gt; multiline {
            #利用正则匹配规则，匹配每一行开始的位置，这里匹配每一行开始的位置为数字
            pattern =&gt; "^[0-9]"
     
            #true表示不匹配正则表达式，false为匹配正则表达式，默认false
            #如果不匹配，则会结合what参数，进行合并操作
            negate =&gt; true
            
            #what可设置previous和next，previous则表示将所有不匹配的数据都合并到上一个正则事件
            #而next则相反，将所有的不匹配的数据都合并到下一个正则事件
            what =&gt; "previous"
 
            #表示当多长时间没有新的数据，最后一个正则匹配积累的多行数据都归属为最后一个事件，这里的10表示10秒
            #auto_flush_interval =&gt; 10
       }
    }
    tcp {
        port =&gt; 8888
        mode =&gt; "server"
        ssl_enable =&gt; false
    }
}
filter {
    grok {
        match =&gt; {
            "message" =&gt; "%{IPORHOST:clientip} - - \[%{HTTPDATE:request_time}\] \"(?:%{WORD:method} %{URIPATH:url}(?:%{URIPARAM:params})?(?: HTTP/%{NUMBER:httpversion})?|%{DATA:rawrequest})\" %{NUMBER:status} (?:%{NUMBER:bytes:int}|-) \"%{DATA:referrer}\" \"%{DATA:agent}\""
        }
    }
    ruby{
        init =&gt; "@kname = ['client','servername','url','status','time','size','upstream','upstreamstatus','upstreamtime','referer','xff','useragent']"
        code =&gt; "
            new_event = LogStash::Event.new(Hash[@kname.zip(event.get('message').split('|'))])
            new_event.remove('@timestamp')
            event.append(new_event)"
    }
}
output {
    #输出控制台
    stdout {
        #codec =&gt; json
    }

    #输出到elasticsearch
    if [type] == "log_index" {
        elasticsearch {
            hosts =&gt; ["192.168.1.31:9200","192.168.1.32:9200"]
            
            #以当前的日期作为index和type
            #index =&gt; "log-%{+YYYY.MM.dd}"
            index =&gt; "%{type}-%{+YYYY.MM.dd}"
            document_type =&gt; "%{type}-%{+YYYY.MM.dd}"
            
            #覆盖模板
            #template_overwrite =&gt; true
            #template =&gt; "/elk/es/logstash/template/logstash.json"
        }
    }

    #输出到文件
    if [type] == "log_file" {
        file {
            path =&gt; "/elk/logstash/logs/website-%{+YYYY.MM.dd}.log"
            flush_interval =&gt; 0
        }
    }

    #输出到Redis
    if [type] == "log_redis" {
        redis {
            host =&gt; "192.168.11.5"
            port =&gt; 7890
            db =&gt; 1
            password =&gt; "123456"
            data_type =&gt; "channel"
            key =&gt; "/wefintek/education/website/logs/website-log"
        }
    }
}
</code></pre>
<ul>
<li>补充file-input字段说明</li>
</ul>
<pre><code>codec =&gt; #可选项，默认是plain，可设置其他编码方式；
discover_interval =&gt; #可选项，logstash多久检查一下path下有新文件，默认15s；
exclude =&gt; #可选项，排除path下不想监听的文件；
sincedb_path =&gt; #可选项，记录文件以及文件读取信息位置的数据文件；
sincedb_write_interval =&gt; #可选项，logstash多久写一次sincedb文件，默认15s；
stat_interval =&gt; #可选项，logstash多久检查一次被监听文件的变化，默认1s；
start_position =&gt; #可选项，表示从哪个位置读取文件数据，初次导入为：beginning，最新数据为：end
path =&gt; #必选项，配置文件路径，可定义多个，也可模糊匹配；
tags =&gt; #可选项，在数据处理过程中，由具体的插件来添加或者删除的标记；
type =&gt; #可选项，当有多个file的时候，可用于一对一匹配输入或者输出；
</code></pre>
<ul>
<li>注意事项</li>
</ul>
<ol>
<li>logstash启动之后，进程会一直处于运行状态，若log文件被修改，程序会自动监听，导入新数据；</li>
<li>若需要重新导入数据，则需要删除logstash数据目录(path.data)下 plugins/inputs/file下的文件，所以直接删除该目录即可，之后目录会重新生成；</li>
<li>如果使用了模板覆盖，需要将模板的message字段设置成分词，否则无法有效进行分词全局搜索。</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../net/net.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../other/elk/elk.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../net/net.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../other/elk/elk.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../../theme/pagetoc.js"></script>


    </body>
</html>
